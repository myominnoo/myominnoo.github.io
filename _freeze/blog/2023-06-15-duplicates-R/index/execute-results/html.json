{
  "hash": "16a6df6a510562e293c06e959e652961",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Duplicates in R\"\nsubtitle: \"List, tag, report duplicates in R like STATA\"\nauthor: \"Myo Minn Oo\"\ndate: 2023-06-15\ndate-modified: last-modified\ndate-format: long\ncategories: \n  - R\n  - Data Wrangling\n  - mStats\ncode-fold: true\ncode-tools: true\ncode-link: true\ncode-line-numbers: true\npage-layout: article\nimage: featured.jpeg\nexecute: \n  cache: false\n---\n\n## Replicating examples on UCLA's STATA tutorial in R\n\n> **Citation**: HOW CAN I DETECT DUPLICATE OBSERVATIONS? \\| STATA FAQ. UCLA: Statistical Consulting Group. from <https://stats.oarc.ucla.edu/stata/faq/how-can-i-detect-duplicate-observations-3/> (accessed June 15, 2023).\n\nThe tutorial on the website used the High School and Beyond dataset. Here are the steps taken to introduce duplicates to the dataset.\n\n### Install mStats\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndevtools::install_github(\"myominnoo/mStats\")\n```\n:::\n\n\n### Downloading a dummy data\n\nStart with the High School and Beyond dataset, which initially has no duplicate observations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nhsb2 <-\n  # load the dataset\n  haven::read_dta(\"https://stats.idre.ucla.edu/stat/stata/notes/hsb2.dta\") |>\n  # select variables of interest\n  dplyr::select(id, female, ses, read, write, math) |>\n  # sort by id\n  dplyr::arrange(id)\n```\n:::\n\n\n### Creating duplicates\n\nAdd five duplicate observations to the dataset to create duplicates. Change a value in one of the duplicate observations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhsb2_mod <-\n  hsb2 |>\n  # take the first five observations\n  slice(1:5) |>\n  # add duplicate observations\n  dplyr::bind_rows(hsb2) |>\n  dplyr::mutate(math = ifelse(dplyr::row_number() == 1, 84, math))\n# display the first few rows\nhsb2_mod\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 205 × 6\n      id female     ses         read write  math\n   <dbl> <dbl+lbl>  <dbl+lbl>  <dbl> <dbl> <dbl>\n 1     1 1 [female] 1 [low]       34    44    84\n 2     2 1 [female] 2 [middle]    39    41    33\n 3     3 0 [male]   1 [low]       63    65    48\n 4     4 1 [female] 1 [low]       44    50    41\n 5     5 0 [male]   1 [low]       47    40    43\n 6     1 1 [female] 1 [low]       34    44    40\n 7     2 1 [female] 2 [middle]    39    41    33\n 8     3 0 [male]   1 [low]       63    65    48\n 9     4 1 [female] 1 [low]       44    50    41\n10     5 0 [male]   1 [low]       47    40    43\n# ℹ 195 more rows\n```\n\n\n:::\n:::\n\n\n### Checking duplicates\n\nAfter adding the duplicate observations, you will have a total of 195 unique observations and 5 duplicated observations in the dataset. We can use the `tag_duplicates()` function from the `mStats` package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhsb2_mod |>\n  # check duplicate report and status using a mStats function\n  dplyr::mutate(mStats::tag_duplicates(dplyr::everything()))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$ Report of duplicates\n  in terms of dplyr::everything()\n copies observations surplus\n      1          197       0\n      2            8       4\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 205 × 9\n      id female     ses         read write  math   .n_   .N_ .dup_\n   <dbl> <dbl+lbl>  <dbl+lbl>  <dbl> <dbl> <dbl> <int> <int> <lgl>\n 1     1 1 [female] 1 [low]       34    44    84     1     1 FALSE\n 2     2 1 [female] 2 [middle]    39    41    33     1     2 FALSE\n 3     3 0 [male]   1 [low]       63    65    48     1     2 FALSE\n 4     4 1 [female] 1 [low]       44    50    41     1     2 FALSE\n 5     5 0 [male]   1 [low]       47    40    43     1     2 FALSE\n 6     1 1 [female] 1 [low]       34    44    40     1     1 FALSE\n 7     2 1 [female] 2 [middle]    39    41    33     2     2 TRUE \n 8     3 0 [male]   1 [low]       63    65    48     2     2 TRUE \n 9     4 1 [female] 1 [low]       44    50    41     2     2 TRUE \n10     5 0 [male]   1 [low]       47    40    43     2     2 TRUE \n# ℹ 195 more rows\n```\n\n\n:::\n:::\n\n\nLet's check duplicates by `id`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhsb2_mod |>\n  # check duplicates by id\n  dplyr::mutate(mStats::tag_duplicates(id))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$ Report of duplicates\n  in terms of id\n copies observations surplus\n      1          195       0\n      2           10       5\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 205 × 9\n      id female     ses         read write  math   .n_   .N_ .dup_\n   <dbl> <dbl+lbl>  <dbl+lbl>  <dbl> <dbl> <dbl> <int> <int> <lgl>\n 1     1 1 [female] 1 [low]       34    44    84     1     2 FALSE\n 2     2 1 [female] 2 [middle]    39    41    33     1     2 FALSE\n 3     3 0 [male]   1 [low]       63    65    48     1     2 FALSE\n 4     4 1 [female] 1 [low]       44    50    41     1     2 FALSE\n 5     5 0 [male]   1 [low]       47    40    43     1     2 FALSE\n 6     1 1 [female] 1 [low]       34    44    40     2     2 TRUE \n 7     2 1 [female] 2 [middle]    39    41    33     2     2 TRUE \n 8     3 0 [male]   1 [low]       63    65    48     2     2 TRUE \n 9     4 1 [female] 1 [low]       44    50    41     2     2 TRUE \n10     5 0 [male]   1 [low]       47    40    43     2     2 TRUE \n# ℹ 195 more rows\n```\n\n\n:::\n:::\n\n\n\n\n> **Photo credit**: [Photo by Dids from Pexels](https://www.pexels.com/photo/mysterious-woman-with-greasepaint-on-face-5782237/)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}